(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))i(n);new MutationObserver(n=>{for(const r of n)if(r.type==="childList")for(const y of r.addedNodes)y.tagName==="LINK"&&y.rel==="modulepreload"&&i(y)}).observe(document,{childList:!0,subtree:!0});function t(n){const r={};return n.integrity&&(r.integrity=n.integrity),n.referrerPolicy&&(r.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?r.credentials="include":n.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function i(n){if(n.ep)return;n.ep=!0;const r=t(n);fetch(n.href,r)}})();const G={work:{time:1500,label:"Focus Time",color:"#f43f5e"},short:{time:300,label:"Short Break",color:"#10b981"},long:{time:900,label:"Long Break",color:"#3b82f6"}};let s=JSON.parse(localStorage.getItem("pomodoro-modes"))||G,E=localStorage.getItem("pomodoro-sound-choice")||"classic",S="work",c=s[S].time,f=!1,C=null,g=s[S].time,a=null,u=!1,l=null,d=null;const H=document.getElementById("time-display"),R=document.getElementById("timer-label"),U=document.getElementById("progress-ring"),w=document.getElementById("btn-toggle"),$=document.getElementById("btn-reset"),N=document.querySelectorAll(".mode-btn"),j=document.body,q=document.getElementById("task-input"),z=document.getElementById("btn-settings"),m=document.getElementById("btn-sound"),p=document.getElementById("settings-modal"),J=document.getElementById("close-modal"),W=document.getElementById("save-settings"),k=document.getElementById("work-time"),b=document.getElementById("short-time"),V=document.getElementById("long-time"),B=document.getElementById("sound-select"),K=document.getElementById("btn-preview-sound"),O=283,Y='<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M11 5L6 9H2v6h4l5 4V5z"/><line x1="23" y1="9" x2="17" y2="15"/><line x1="17" y1="9" x2="23" y2="15"/></svg>',Q='<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"></polygon><path d="M19.07 4.93a10 10 0 0 1 0 14.14M15.54 8.46a5 5 0 0 1 0 7.07"></path></svg>';function X(){Z(),se(),ee(),D("work")}function Z(){w.addEventListener("click",ae),$.addEventListener("click",le),N.forEach(e=>{e.addEventListener("click",()=>{const o=e.dataset.mode;D(o)})}),q.addEventListener("input",e=>{localStorage.setItem("pomodoro-task",e.target.value)}),z.addEventListener("click",oe),J.addEventListener("click",L),W.addEventListener("click",ie),p.addEventListener("click",e=>{e.target===p&&L()}),m.addEventListener("click",ne),K.addEventListener("click",()=>{const e=B.value;F(e)})}function ee(){const e=localStorage.getItem("pomodoro-task");e&&(q.value=e)}function x(){a||(a=new(window.AudioContext||window.webkitAudioContext)),a.state==="suspended"&&a.resume()}function te(){F(E)}function F(e){x();const o=a,t=o.currentTime,i=o.createOscillator(),n=o.createGain();i.connect(n),n.connect(o.destination),e==="classic"?(i.type="sine",i.frequency.setValueAtTime(880,t),i.frequency.exponentialRampToValueAtTime(440,t+.5),n.gain.setValueAtTime(.8,t),n.gain.exponentialRampToValueAtTime(.01,t+.5),i.start(t),i.stop(t+.5)):e==="digital"?(i.type="square",i.frequency.setValueAtTime(1200,t),n.gain.setValueAtTime(.1,t),n.gain.setValueAtTime(0,t+.1),i.frequency.setValueAtTime(1200,t+.15),n.gain.setValueAtTime(.1,t+.15),n.gain.setValueAtTime(0,t+.25),i.start(t),i.stop(t+.3)):e==="chime"?[523.25,659.25,783.99,1046.5].forEach((y,_)=>{const v=o.createOscillator(),h=o.createGain();v.connect(h),h.connect(o.destination),v.frequency.value=y,v.type="triangle";const T=t+_*.1;h.gain.setValueAtTime(0,T),h.gain.linearRampToValueAtTime(.2,T+.1),h.gain.exponentialRampToValueAtTime(.01,T+2),v.start(T),v.stop(T+2)}):e==="alarm"&&(i.type="sawtooth",i.frequency.value=880,n.gain.setValueAtTime(.3,t),n.gain.setValueAtTime(0,t+.2),n.gain.setValueAtTime(.3,t+.4),n.gain.setValueAtTime(0,t+.6),n.gain.setValueAtTime(.3,t+.8),n.gain.setValueAtTime(0,t+1),i.start(t),i.stop(t+1))}function ne(){x(),u=!u,m.dataset.state=u?"on":"off",m.innerHTML=u?Q:Y,u?(m.style.color="var(--current-accent)",f&&P()):(m.style.color="var(--text-muted)",M())}function P(){if(!u||!a||l)return;const e=a.sampleRate*2,o=a.createBuffer(1,e,a.sampleRate),t=o.getChannelData(0);let i=0;for(let n=0;n<e;n++){const r=Math.random()*2-1;i=(i+.02*r)/1.02,t[n]=i*3.5,t[n]*=.1}l=a.createBufferSource(),l.buffer=o,l.loop=!0,d=a.createGain(),d.gain.setValueAtTime(0,a.currentTime),d.gain.linearRampToValueAtTime(.5,a.currentTime+1),l.connect(d),d.connect(a.destination),l.start()}function M(){if(l&&d){const e=a.currentTime+.5;d.gain.linearRampToValueAtTime(0,e),l.stop(e),setTimeout(()=>{l=null,d=null},600)}}function oe(){k.value=Math.floor(s.work.time/60),b.value=Math.floor(s.short.time/60),V.value=Math.floor(s.long.time/60),B.value=E,p.classList.remove("hidden"),p.setAttribute("aria-hidden","false")}function L(){p.classList.add("hidden"),p.setAttribute("aria-hidden","true")}function ie(){const e=parseInt(k.value)||25,o=parseInt(b.value)||5,t=parseInt(V.value)||15;s.work.time=e*60,s.short.time=o*60,s.long.time=t*60,E=B.value,localStorage.setItem("pomodoro-modes",JSON.stringify(s)),localStorage.setItem("pomodoro-sound-choice",E),f||(g=s[S].time,c=g,A()),L()}function se(){k.value=Math.floor(s.work.time/60),b.value=Math.floor(s.short.time/60),V.value=Math.floor(s.long.time/60)}function D(e){S=e,g=s[e].time,c=g,M(),N.forEach(o=>{o.classList.toggle("active",o.dataset.mode===e),o.setAttribute("aria-selected",o.dataset.mode===e)}),document.documentElement.style.setProperty("--current-accent",s[e].color),j.setAttribute("data-mode",e),u&&(m.style.color=s[e].color),R.textContent=s[e].label,I(),A()}function ae(){f?I():re()}function re(){f||(x(),f=!0,w.textContent="Pause",w.classList.add("active"),u&&P(),C=setInterval(()=>{c>0?(c--,A()):ce()},1e3))}function I(){f=!1,w.textContent="Start",w.classList.remove("active"),clearInterval(C),M()}function le(){I(),c=g,A()}function ce(){I(),c=0,A(),te(),R.textContent="Time is up!"}function A(){const e=Math.floor(c/60),o=c%60,t=`${e.toString().padStart(2,"0")}:${o.toString().padStart(2,"0")}`;H.textContent=t,document.title=`${t} - PomoFocus`,ue(c)}function ue(e){const t=e/g,i=O-t*O;U.style.strokeDashoffset=i}X();
